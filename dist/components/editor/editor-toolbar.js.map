{"version":3,"file":"editor-toolbar.js","sourceRoot":"","sources":["../../../src/components/editor/editor-toolbar.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { editorToolbarStyle } from '../../styles/editor-toolbar.style';\nimport { ChapterRange, CurrentlyGrabbed, RangeTimings } from '../../types';\nimport ChapterAddedEvent from '../../events/chapter-added';\nimport FilesAddedEvent from '../../events/files-added';\nimport VideoLoadedEvent from '../../events/video-loaded';\nimport './editor-sidebar';\nimport './editor-timeline';\nimport '../../icons/icon-plus';\nimport '../../icons/icon-redo-arrow';\nimport '../../icons/icon-save';\nimport '../../icons/icon-trash';\nimport '../../icons/icon-undo-arrow';\n\n@customElement('editor-toolbar')\nexport class EditorToolbar extends LitElement {\n  static override styles = editorToolbarStyle;\n  \n  @property({ type: Array })\n  timings: Array<RangeTimings> = [];\n\n  @property({ type: Object })\n  currentlyGrabbed?: CurrentlyGrabbed;\n\n  private ranges: Array<ChapterRange> = [];\n  private selectedFile: any;\n  private videoDuration = 0;\n\n  constructor() {\n    super();\n\n    this.addEventListener(FilesAddedEvent.eventName, ((e: FilesAddedEvent) => {\n      this.selectedFile = e.detail.files;\n    }) as EventListener);\n\n    this.addEventListener(VideoLoadedEvent.eventName, ((e: VideoLoadedEvent) => {\n      this.videoDuration = e.detail.duration;\n    }) as EventListener);\n  }\n\n  override render() {\n    return html`\n      <div class=\"toolbar\">\n        <div class=\"toolbar__group\">\n          <button title=\"undo\" class=\"toolbar__button\">\n          <icon-undo-arrow></icon-undo-arrow>\n          </button>\n          <button title=\"redo\" class=\"toolbar__button\">\n            <icon-redo-arrow></icon-redo-arrow>\n          </button>\n          <button @click=\"${this.saveRange}\" title=\"add\" class=\"toolbar__button\">\n            <icon-plus></icon-plus>\n          </button>\n        </div>\n        <div class=\"toolbar__group\">\n          <strong class=\"toolbar__timeinfo text\" id=\"timeInfo\">00:00:00 / 00:00:00</strong>\n        </div>\n        <div class=\"toolbar__group\">\n          <button @click=\"${this.exportJson}\" title=\"save\" class=\"toolbar__button\">\n            <icon-save></icon-save>\n          </button>\n          <button title=\"delete\" class=\"toolbar__button\">\n            <icon-trash></icon-trash>\n          </button>\n        </div>\n        <editor-timeline .timings=${this.timings} .currentlyGrabbed=${this.currentlyGrabbed}></editor-timeline>\n      </div>\n    `;\n  }\n\n  private saveRange() {\n    const title = 'chapters';\n    const times = this.timings[0];\n    this.ranges.push({ title, range: { ...times } });\n\n    const sizeRange = [\n      times.start / this.videoDuration * 100,\n      times.end / this.videoDuration * 100\n    ];\n\n    this.dispatchEvent(new ChapterAddedEvent({ bubbles: true, composed: true, detail: { title, sizeRange } }));\n  }\n\n  private exportJson() {\n    const json = {\n      fileName: this.selectedFile.name,\n      chapters: this.ranges,\n    };\n\n    const dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(json));\n    const name = 'video-chapters.json';\n\n    const anchor = document.createElement('a');\n    anchor.href = dataStr;\n    anchor.download = name;\n    anchor.click();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'editor-toolbar': EditorToolbar;\n  }\n}\n"]}